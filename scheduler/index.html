<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Scheduler - Professional Project Management</title>
    <link rel="stylesheet" href="css/scheduler.css">
</head>
<body>
    <!-- Toolbar -->
    <div class="toolbar">
        <div class="toolbar-section toolbar-left">
            <button class="toolbar-btn" id="btnNewProject" title="New Project">
                <svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/></svg>
                <span>New</span>
            </button>
            <button class="toolbar-btn" id="btnLoadProject" title="Load Project">
                <svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M19,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4H10L12,6H19A2,2 0 0,1 21,8H21L4,8V18L6.14,10H23.21L20.93,18.5C20.7,19.37 19.92,20 19,20Z"/></svg>
                <span>Open</span>
            </button>
            <button class="toolbar-btn" id="btnSaveProject" title="Save Project">
                <svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"/></svg>
                <span>Save</span>
            </button>
            <div class="toolbar-divider"></div>
            <button class="toolbar-btn" id="btnAddTask" title="Add Task">
                <svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/></svg>
                <span>Add Task</span>
            </button>
            <button class="toolbar-btn" id="btnAddMilestone" title="Add Milestone">
                <svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M16,12V4H17V2H7V4H8V12L6,14V16H11.2V22H12.8V16H18V14L16,12Z"/></svg>
                <span>Milestone</span>
            </button>
            <button class="toolbar-btn" id="btnDeleteTask" title="Delete Selected Task">
                <svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"/></svg>
                <span>Delete</span>
            </button>
        </div>
        <div class="toolbar-section toolbar-center">
            <button class="toolbar-btn" id="btnZoomOut" title="Zoom Out">
                <svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M19,13H5V11H19V13Z"/></svg>
            </button>
            <span class="zoom-level" id="zoomLevel">Day</span>
            <button class="toolbar-btn" id="btnZoomIn" title="Zoom In">
                <svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/></svg>
            </button>
            <div class="toolbar-divider"></div>
            <button class="toolbar-btn" id="btnToggleCritical" title="Toggle Critical Path">
                <svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16"/></svg>
                <span>Critical</span>
            </button>
            <button class="toolbar-btn" id="btnRecalculate" title="Recalculate Schedule">
                <svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4M18.12,6.46A8,8 0 0,1 20,12H22A10,10 0 0,0 15.54,5.46L18.12,6.46M18.46,17.66L17.04,16.24A8,8 0 0,1 12,20V22A10,10 0 0,0 18.46,17.66M6,20V18A8,8 0 0,1 7.54,12H6.08L12,6.08L17.92,12H16.46A8,8 0 0,1 18,12H20A10,10 0 0,0 6,20Z"/></svg>
                <span>Recalc</span>
            </button>
        </div>
        <div class="toolbar-section toolbar-right">
            <button class="toolbar-btn" id="btnImportCSV" title="Import CSV">
                <svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M13.5,16V19H10.5V16H8L12,12L16,16M13,9V3.5L18.5,9"/></svg>
                <span>Import</span>
            </button>
            <button class="toolbar-btn" id="btnExportCSV" title="Export CSV">
                <svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M13,13H11V17H9V13H7V11H9V7H11V11H13V13M13,9V3.5L18.5,9"/></svg>
                <span>Export</span>
            </button>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Task Table (Left Panel) -->
        <div class="task-table-container" id="taskTableContainer">
            <table class="task-table" id="taskTable">
                <thead>
                    <tr>
                        <th class="col-id">ID</th>
                        <th class="col-name">Task Name</th>
                        <th class="col-start">Start</th>
                        <th class="col-end">End</th>
                        <th class="col-duration">Dur</th>
                        <th class="col-progress">%</th>
                        <th class="col-predecessors">Predecessors</th>
                        <th class="col-float">Float</th>
                        <th class="col-critical">Critical</th>
                    </tr>
                </thead>
                <tbody id="taskTableBody">
                </tbody>
            </table>
        </div>

        <!-- Gantt Chart (Right Panel) -->
        <div class="gantt-container" id="ganttContainer">
            <div class="gantt-header" id="ganttHeader">
                <!-- Time scale header will be rendered here -->
            </div>
            <div class="gantt-body" id="ganttBody">
                <svg id="ganttSvg" xmlns="http://www.w3.org/2000/svg">
                    <!-- Grid lines -->
                    <g id="gridLines"></g>
                    <!-- Dependency lines -->
                    <g id="dependencyLines"></g>
                    <!-- Task bars -->
                    <g id="taskBars"></g>
                </svg>
            </div>
        </div>
    </div>

    <!-- Status Bar -->
    <div class="status-bar">
        <div class="status-section">
            <span class="status-label">Project:</span>
            <span class="status-value" id="projectName">Untitled Project</span>
        </div>
        <div class="status-section">
            <span class="status-label">Start:</span>
            <span class="status-value" id="projectStart">-</span>
        </div>
        <div class="status-section">
            <span class="status-label">Finish:</span>
            <span class="status-value" id="projectFinish">-</span>
        </div>
        <div class="status-section">
            <span class="status-label">Duration:</span>
            <span class="status-value" id="projectDuration">0 days</span>
        </div>
        <div class="status-section">
            <span class="status-label">Tasks:</span>
            <span class="status-value" id="taskCount">0</span>
        </div>
        <div class="status-section">
            <span class="status-label">Critical Path:</span>
            <span class="status-value" id="criticalPercent">0%</span>
        </div>
        <div class="status-section status-message" id="statusMessage">
            Ready
        </div>
    </div>

    <!-- Task Edit Modal -->
    <div class="modal-overlay" id="taskModal">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modalTitle">Add Task</h3>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body">
                <form id="taskForm">
                    <input type="hidden" id="taskId">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="taskName">Task Name</label>
                            <input type="text" id="taskName" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="taskStart">Start Date</label>
                            <input type="date" id="taskStart" required>
                        </div>
                        <div class="form-group">
                            <label for="taskDuration">Duration (days)</label>
                            <input type="number" id="taskDuration" min="1" value="1" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="taskPercent">% Complete</label>
                            <input type="number" id="taskPercent" min="0" max="100" value="0">
                        </div>
                        <div class="form-group">
                            <label for="taskMilestone">
                                <input type="checkbox" id="taskMilestone">
                                Is Milestone
                            </label>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="taskPredecessors">Predecessors (Task ID,Type,Lag)</label>
                            <input type="text" id="taskPredecessors" placeholder="e.g., T1,FS,0; T2,SS,2">
                            <small>Separate multiple predecessors with semicolons. Types: FS, SS, FF, SF</small>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="taskNotes">Notes</label>
                            <textarea id="taskNotes" rows="3"></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="btnCancelTask">Cancel</button>
                <button class="btn btn-primary" id="btnSaveTask">Save Task</button>
            </div>
        </div>
    </div>

    <!-- Project Load Modal -->
    <div class="modal-overlay" id="loadModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Open Project</h3>
                <button class="modal-close" id="loadModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div id="savedProjectsList" class="saved-projects-list">
                    <!-- Saved projects will be listed here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="btnNewProjectFromModal">New Project</button>
                <button class="btn btn-danger" id="btnClearStorage">Clear All</button>
            </div>
        </div>
    </div>

    <!-- CSV Import Modal -->
    <div class="modal-overlay" id="importModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Import CSV</h3>
                <button class="modal-close" id="importModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="import-instructions">
                    <h4>CSV Format</h4>
                    <p>Your CSV should have these columns:</p>
                    <code>ID,Name,StartDate,Duration,PercentComplete,IsMilestone,Predecessors</code>
                    <p>Predecessors format: <code>T1,FS,0;T2,SS,2</code></p>
                    <p>Date format: <code>YYYY-MM-DD</code></p>
                </div>
                <div class="form-group">
                    <label for="csvFile">Select CSV File</label>
                    <input type="file" id="csvFile" accept=".csv">
                </div>
                <div id="importPreview" class="import-preview">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="btnCancelImport">Cancel</button>
                <button class="btn btn-primary" id="btnConfirmImport">Import</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Scripts -->
    <script src="js/task-manager.js"></script>
    <script src="js/schedule-calc.js"></script>
    <script src="js/gantt-renderer.js"></script>
    <script src="js/dependency-lines.js"></script>
    <script src="js/csv-handler.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/scheduler.js"></script>
</body>
</html>
